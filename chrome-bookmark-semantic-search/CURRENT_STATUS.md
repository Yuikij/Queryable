# ğŸ“Š å½“å‰çŠ¶æ€è¯´æ˜

## âœ… å¯ç”¨ç‰ˆæœ¬ï¼šTF-IDF å‘é‡æœç´¢

ç”±äº Chrome Extension Manifest V3 çš„ Service Worker æŠ€æœ¯é™åˆ¶ï¼Œ**å½“å‰ä½¿ç”¨ TF-IDF ç‰ˆæœ¬**ã€‚

```json
// manifest.json
{
  "background": {
    "service_worker": "background_pure_vector.js"
  }
}
```

---

## ğŸ¯ TF-IDF ç‰ˆæœ¬ç‰¹ç‚¹

### âœ… ä¼˜åŠ¿

1. **æ— éœ€å¤–éƒ¨ä¾èµ–**
   - çº¯ JavaScript å®ç°
   - ä¸éœ€è¦ä¸‹è½½æ¨¡å‹
   - å®Œå…¨ç¬¦åˆ Service Worker è§„èŒƒ

2. **å¿«é€Ÿåˆå§‹åŒ–**
   - 3-5åˆ†é’Ÿå®Œæˆç´¢å¼•æ„å»º
   - åç»­å¯åŠ¨ <1ç§’

3. **å®Œæ•´åŠŸèƒ½**
   - æ”¯æŒä¸­è‹±æ–‡æ··åˆæœç´¢
   - æ™ºèƒ½åˆ†è¯ï¼ˆä¸­æ–‡ n-gramï¼Œè‹±æ–‡ç©ºæ ¼åˆ†è¯ï¼‰
   - ç½‘é¡µå†…å®¹æŠ“å–å’Œç´¢å¼•
   - å¢é‡æ›´æ–°æ”¯æŒ
   - IndexedDB æŒä¹…åŒ–

4. **é«˜æ€§èƒ½**
   - ç¨€ç–å€’æ’ç´¢å¼•ï¼ˆå— Queryable å¯å‘ï¼‰
   - ä½™å¼¦ç›¸ä¼¼åº¦å¿«é€Ÿè®¡ç®—
   - æ¯«ç§’çº§æœç´¢å“åº”

### ğŸ“Š æœç´¢æ•ˆæœ

#### é€‚åˆçš„æŸ¥è¯¢
```
âœ… "JavaScript"      â†’ æ‰¾åˆ°æ‰€æœ‰ JS ç›¸å…³ä¹¦ç­¾
âœ… "Python æ•™ç¨‹"     â†’ ç²¾ç¡®åŒ¹é…æ ‡é¢˜å’Œå†…å®¹
âœ… "æœºå™¨å­¦ä¹ "        â†’ ä¸­æ–‡è¯æ±‡åŒ¹é…
âœ… "GitHub"          â†’ åŸŸåå’Œæ ‡é¢˜åŒ¹é…
âœ… "Docker å®¹å™¨"     â†’ æŠ€æœ¯è¯æ±‡ç»„åˆ
```

#### é™åˆ¶
```
âŒ "æ’è§£å¿§è™‘"        â†’ åªèƒ½åŒ¹é…å­—é¢è¯æ±‡ï¼ˆä¸ç†è§£"å†¥æƒ³"ã€"æ”¾æ¾"ï¼‰
âŒ "ç±»ä¼¼å­¤ç‹¬"        â†’ æ— æ³•ç†è§£æŠ½è±¡æ¦‚å¿µ
âŒ "å¯¹å­¦ä¹ æœ‰å¸®åŠ©"    â†’ ä¸ç†è§£æ„å›¾
âŒ "å¿ƒæƒ…ä¸å¥½"        â†’ ä¸æ”¯æŒæƒ…æ„ŸæŸ¥è¯¢
```

### å·¥ä½œåŸç†

```
1. æ–‡æœ¬é¢„å¤„ç†:
   ä¹¦ç­¾æ ‡é¢˜ + URL + ç½‘é¡µå†…å®¹ â†’ åˆ†è¯

2. TF-IDF å‘é‡åŒ–:
   æ¯ä¸ªä¹¦ç­¾ â†’ TF-IDF å‘é‡ï¼ˆç¨€ç–è¡¨ç¤ºï¼‰

3. å€’æ’ç´¢å¼•:
   è¯æ±‡ â†’ åŒ…å«è¯¥è¯çš„ä¹¦ç­¾åˆ—è¡¨

4. æœç´¢:
   æŸ¥è¯¢ â†’ TF-IDF å‘é‡ â†’ ç¨€ç–ç‚¹ç§¯ â†’ æ’åºç»“æœ
```

---

## ğŸ”® è¯­ä¹‰æœç´¢ç‰ˆæœ¬ï¼ˆå·²å®ç°ä½†å—é™ï¼‰

### çŠ¶æ€

âœ… **ä»£ç å·²å®Œæˆ**: `background_semantic.js`
âŒ **æ— æ³•ç›´æ¥ä½¿ç”¨**: Service Worker é™åˆ¶
ğŸ”„ **éœ€è¦æ‰“åŒ…**: webpack/rollup

### ä¸ºä»€ä¹ˆæ— æ³•ç›´æ¥ä½¿ç”¨ï¼Ÿ

Chrome Extension Manifest V3 çš„ Service Worker æœ‰ä¸¥æ ¼é™åˆ¶ï¼š

```javascript
// âŒ ä¸æ”¯æŒ
import { pipeline } from '@xenova/transformers';

// âŒ ä¸æ”¯æŒ
const module = await import('https://cdn.../transformers.js');

// âŒ ä¸æ”¯æŒ
eval(code);
```

é”™è¯¯ä¿¡æ¯ï¼š
```
TypeError: import() is disallowed on ServiceWorkerGlobalScope 
by the HTML specification.
See https://github.com/w3c/ServiceWorker/issues/1356
```

### æŠ€æœ¯ç»†èŠ‚

è¯­ä¹‰æœç´¢ç‰ˆæœ¬ä½¿ç”¨ï¼š
- **æ¨¡å‹**: Sentence-BERT (paraphrase-multilingual-MiniLM-L12-v2)
- **åº“**: Transformers.js
- **å‘é‡ç»´åº¦**: 384ç»´
- **ç†è§£èƒ½åŠ›**: çœŸæ­£çš„è¯­ä¹‰ç†è§£

ä½† Transformers.js éœ€è¦ï¼š
- åŠ¨æ€åŠ è½½æ¨¡å‹æ–‡ä»¶
- ä½¿ç”¨ WebAssembly
- ä¾èµ– ES modules
- è¿™äº›éƒ½ä¸ Service Worker é™åˆ¶å†²çª

---

## ğŸ› ï¸ å¦‚ä½•å¯ç”¨è¯­ä¹‰æœç´¢ï¼Ÿ

### æ–¹æ¡ˆ1: ä½¿ç”¨ Webpack æ‰“åŒ…ï¼ˆæ¨èï¼‰

åˆ›å»º `webpack.config.js`:
```javascript
module.exports = {
  entry: './background_semantic.js',
  output: {
    filename: 'background_bundled.js'
  },
  mode: 'production',
  target: 'webworker'
};
```

æ‰“åŒ…:
```bash
npx webpack
```

æ›´æ–° manifest.json:
```json
{
  "background": {
    "service_worker": "background_bundled.js"
  }
}
```

### æ–¹æ¡ˆ2: ç­‰å¾…æµè§ˆå™¨æ”¯æŒ

Chrome å›¢é˜Ÿæ­£åœ¨è®¨è®ºæ”¾å®½ Service Worker é™åˆ¶ï¼š
- https://github.com/w3c/ServiceWorker/issues/1356
- å¯èƒ½åœ¨æœªæ¥ç‰ˆæœ¬æ”¯æŒ

### æ–¹æ¡ˆ3: ä½¿ç”¨å¤–éƒ¨ API

è°ƒç”¨è¯­ä¹‰ APIï¼ˆå¦‚ OpenAI Embeddingsï¼‰ï¼š
```javascript
// ä¸å†å®Œå…¨æœ¬åœ°åŒ–ï¼Œä½†å¯ä»¥è·å¾—è¯­ä¹‰ç†è§£
const embedding = await fetch('https://api.openai.com/v1/embeddings', {
  method: 'POST',
  body: JSON.stringify({
    model: 'text-embedding-3-small',
    input: query
  })
});
```

---

## ğŸ“š é¡¹ç›®æ–‡ä»¶è¯´æ˜

### å½“å‰ä½¿ç”¨
- âœ… `background_pure_vector.js` - TF-IDF æœç´¢å¼•æ“ï¼ˆå½“å‰ï¼‰
- âœ… `manifest.json` - æŒ‡å‘ TF-IDF ç‰ˆæœ¬
- âœ… `popup.js` + `popup.html` - UI ç•Œé¢

### å¤‡ç”¨/å‚è€ƒ
- ğŸ”® `background_semantic.js` - è¯­ä¹‰æœç´¢å¼•æ“ï¼ˆéœ€æ‰“åŒ…ï¼‰
- ğŸ“– `SEMANTIC_SEARCH_GUIDE.md` - è¯­ä¹‰æœç´¢æŒ‡å—
- ğŸ“– `CLIP_SEMANTIC_SEARCH.md` - æŠ€æœ¯åŸç†
- ğŸ“– `SERVICE_WORKER_LIMITATION.md` - é™åˆ¶è¯´æ˜

### æ–‡æ¡£
- ğŸ“– `README.md` - ä¸»æ–‡æ¡£
- ğŸ“– `INCREMENTAL_INDEX.md` - å¢é‡ç´¢å¼•
- ğŸ“– `CURRENT_STATUS.md` - æœ¬æ–‡æ¡£

---

## ğŸš€ å¿«é€Ÿå¼€å§‹

### å®‰è£…ä½¿ç”¨

1. **é‡æ–°åŠ è½½æ‰©å±•**
   ```
   chrome://extensions/ â†’ é‡æ–°åŠ è½½
   ```

2. **ç­‰å¾…åˆå§‹åŒ–**ï¼ˆ3-5åˆ†é’Ÿï¼‰
   ```
   ğŸ”¨ æ„å»ºå€’æ’ç´¢å¼•...
   ğŸ“Š è¿›åº¦: 500/1985
   âœ… ç´¢å¼•æ„å»ºå®Œæˆ
   ```

3. **å¼€å§‹æœç´¢**
   ```
   è¯•è¯•: "JavaScript"
   è¯•è¯•: "Python æ•™ç¨‹"
   è¯•è¯•: "æœºå™¨å­¦ä¹ "
   ```

### æŸ¥çœ‹æ—¥å¿—

```
chrome://extensions/ â†’ service worker â†’ Console
```

### å¼ºåˆ¶é‡å»º

```javascript
// åœ¨ service worker console:
indexedDB.deleteDatabase('BookmarkSearchDB');
```

---

## ğŸ’¡ å»ºè®®

### æ—¥å¸¸ä½¿ç”¨
âœ… **å½“å‰ TF-IDF ç‰ˆæœ¬å·²è¶³å¤Ÿå¼ºå¤§**
- æ”¯æŒç²¾ç¡®æœç´¢
- ä¸­è‹±æ–‡æ··åˆ
- å¿«é€Ÿå“åº”
- å®Œå…¨æœ¬åœ°åŒ–

### é«˜çº§éœ€æ±‚
å¦‚æœç¡®å®éœ€è¦è¯­ä¹‰ç†è§£ï¼š
1. å­¦ä¹  webpack æ‰“åŒ…
2. æˆ–ç­‰å¾…æµè§ˆå™¨æ”¯æŒæ”¹è¿›
3. æˆ–è€ƒè™‘ä½¿ç”¨å¤–éƒ¨ API

### æŠ€æœ¯å­¦ä¹ 
- `background_semantic.js` æä¾›äº†å®Œæ•´çš„è¯­ä¹‰æœç´¢å®ç°
- å¯ä½œä¸ºå­¦ä¹  Transformers.js çš„å‚è€ƒ
- ç†è§£ Queryable çš„æŠ€æœ¯æ€è·¯

---

## ğŸ¯ æ€»ç»“

### å½“å‰çŠ¶æ€
âœ… **TF-IDF ç‰ˆæœ¬å¯ç”¨** - å¼ºå¤§çš„æœ¬åœ°å‘é‡æœç´¢  
ğŸ”® **è¯­ä¹‰ç‰ˆæœ¬å¾…æ‰“åŒ…** - ä»£ç å®Œæˆï¼Œéœ€æ‰“åŒ…å·¥å…·

### æ ¸å¿ƒä»·å€¼
è™½ç„¶å—æŠ€æœ¯é™åˆ¶æ— æ³•ç›´æ¥ä½¿ç”¨è¯­ä¹‰æœç´¢ï¼Œä½†ï¼š
- TF-IDF ç‰ˆæœ¬å·²ç»å¾ˆå¼ºå¤§
- æä¾›äº†å®Œæ•´çš„è¯­ä¹‰æœç´¢ä»£ç 
- å±•ç¤ºäº† Queryable å¯å‘çš„æŠ€æœ¯æ€è·¯
- ä¸ºæœªæ¥å‡çº§åšå¥½å‡†å¤‡

### è‡´è°¢
**æ„Ÿè°¢ [Queryable](https://github.com/mazzzystar/Queryable) çš„å¯å‘ï¼**

è™½ç„¶æµè§ˆå™¨ç¯å¢ƒæœ‰é™åˆ¶ï¼Œä½†æˆ‘ä»¬å°½å¯èƒ½å®ç°äº†ç›¸ä¼¼çš„æŠ€æœ¯æ¶æ„ã€‚

---

**å¼€å§‹ä½¿ç”¨å½“å‰ç‰ˆæœ¬ï¼Œäº«å—æœ¬åœ°å‘é‡æœç´¢ï¼** ğŸš€

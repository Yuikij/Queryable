# ğŸ“Š å¢é‡ç´¢å¼•ä¼˜åŒ–æ–¹æ¡ˆ

## é—®é¢˜æè¿°

**é—®é¢˜**: æ¯æ¬¡ç”µè„‘é‡å¯æˆ–æµè§ˆå™¨é‡å¯åï¼Œæ’ä»¶éƒ½ä¼šé‡æ–°æ„å»ºå®Œæ•´ç´¢å¼•ï¼Œå³ä½¿ä¹¦ç­¾æ²¡æœ‰ä»»ä½•å˜åŒ–ã€‚

**åŸå› åˆ†æ**:
1. ç­¾åè®¡ç®—åŒ…å«äº†ä¸ç¨³å®šçš„å­—æ®µï¼ˆ`dateAdded`ï¼‰
2. ç¼ºå°‘å¢é‡æ›´æ–°æœºåˆ¶
3. ç¼“å­˜éªŒè¯é€»è¾‘ä¸å¤Ÿæ™ºèƒ½

## è§£å†³æ–¹æ¡ˆ

### âœ… 1. ä¼˜åŒ–ç­¾åè®¡ç®—

**ä¿®æ”¹å‰**ï¼š
```javascript
// åŒ…å« dateAdded å­—æ®µï¼Œå¯èƒ½å¯¼è‡´è¯¯åˆ¤
const payload = bookmarks
  .map(b => `${b.id}|${b.title}|${b.url}|${b.dateAdded || ''}`)
  .sort()
  .join('\n');
```

**ä¿®æ”¹å**ï¼š
```javascript
// åªä½¿ç”¨ç¨³å®šå­—æ®µï¼šid, title, url
const payload = bookmarks
  .map(b => `${b.id}|${b.title}|${b.url}`)
  .sort()
  .join('\n');
```

### âœ… 2. å¢é‡ç´¢å¼•æ›´æ–°

å½“æ£€æµ‹åˆ°ä¹¦ç­¾å˜åŒ–æ—¶ï¼š

#### æ™ºèƒ½æ£€æµ‹é€»è¾‘
```javascript
// è®¡ç®—å˜åŒ–ç‡
const changeRatio = (added.length + removed.length) / total;

if (changeRatio < 20%) {
  // å¢é‡æ›´æ–°
  - åˆ é™¤å·²ç§»é™¤çš„ä¹¦ç­¾ç´¢å¼•
  - åªå¤„ç†æ–°å¢çš„ä¹¦ç­¾
  - é‡æ–°è®¡ç®—å…¨å±€IDF
} else {
  // å®Œå…¨é‡å»ºï¼ˆå˜åŒ–è¿‡å¤§æ—¶æ›´é«˜æ•ˆï¼‰
}
```

#### å¢é‡æ›´æ–°æ­¥éª¤
1. **åˆ é™¤ç´¢å¼•**: ä»å€’æ’ç´¢å¼•ä¸­ç§»é™¤å·²åˆ é™¤ä¹¦ç­¾çš„æ¡ç›®
2. **æ·»åŠ æ–°ä¹¦ç­¾**: ä»…è·å–å’Œå¤„ç†æ–°å¢ä¹¦ç­¾çš„å†…å®¹
3. **æ›´æ–°IDF**: åŸºäºæ–°çš„æ–‡æ¡£é›†é‡æ–°è®¡ç®—IDFå€¼
4. **ä¿å­˜ç¼“å­˜**: æ›´æ–°IndexedDBä¸­çš„ç´¢å¼•æ•°æ®

### âœ… 3. å¢å¼ºçš„ç¼“å­˜éªŒè¯

```javascript
// ä¸‰ç§åŠ è½½ç»“æœ
{
  loaded: true,           // å®Œå…¨åŒ¹é…ï¼Œç›´æ¥ä½¿ç”¨
  canIncremental: false
}

{
  loaded: false,          // å¯ä»¥å¢é‡æ›´æ–°
  canIncremental: true,
  added: [...],          // æ–°å¢çš„ä¹¦ç­¾
  removed: [...]         // åˆ é™¤çš„ä¹¦ç­¾ID
}

{
  loaded: false,          // éœ€è¦å®Œå…¨é‡å»º
  canIncremental: false
}
```

### âœ… 4. è¯¦ç»†çš„è°ƒè¯•æ—¥å¿—

**å¯åŠ¨æ—¶çš„æ—¥å¿—è¾“å‡º**ï¼š
```
å¼€å§‹åˆå§‹åŒ–çº¯å‘é‡æœç´¢å¼•æ“...
å½“å‰ä¹¦ç­¾ç­¾å: a3b5c7d9, å…± 1985 ä¸ªä¹¦ç­¾
ğŸ“‹ ç¼“å­˜ç­¾å: a3b5c7d9, å½“å‰ç­¾å: a3b5c7d9
âœ… ç­¾ååŒ¹é…ï¼Œå¼€å§‹åŠ è½½ç´¢å¼•...
âœ… ç´¢å¼•åŠ è½½å®Œæˆ
âœ… å·²ä»æœ¬åœ°ç¼“å­˜åŠ è½½ç´¢å¼•ï¼Œè·³è¿‡é‡å»º
```

**å¢é‡æ›´æ–°æ—¶çš„æ—¥å¿—**ï¼š
```
ğŸ“‹ ç¼“å­˜ç­¾å: a3b5c7d9, å½“å‰ç­¾å: b4c6d8e0
ğŸ“Š å˜åŒ–ç‡: 2.5%, å¯è¿›è¡Œå¢é‡æ›´æ–°
ğŸ”„ æ£€æµ‹åˆ°å¢é‡å˜åŒ–ï¼Œæ–°å¢: 50, åˆ é™¤: 0
ğŸ”„ å¼€å§‹å¢é‡æ›´æ–°: æ–°å¢ 50, åˆ é™¤ 0
ğŸ”„ é‡æ–°è®¡ç®—å…¨å±€IDF...
âœ… å¢é‡æ›´æ–°å®Œæˆ
âœ… ç´¢å¼•å·²ä¿å­˜åˆ°æœ¬åœ°ç¼“å­˜
```

**å®Œå…¨é‡å»ºæ—¶çš„æ—¥å¿—**ï¼š
```
ğŸ“‹ ç¼“å­˜ç­¾å: a3b5c7d9, å½“å‰ç­¾å: c5d7e9f1
âš ï¸ å˜åŒ–ç‡è¿‡å¤§ (45.2%), éœ€è¦å®Œå…¨é‡å»º
ğŸ”¨ æ‰§è¡Œå®Œæ•´ç´¢å¼•é‡å»º...
æ­£åœ¨è·å–ç½‘é¡µå†…å®¹ (1/1985)
...
âœ… çº¯å‘é‡æœç´¢å¼•æ“åˆå§‹åŒ–å®Œæˆï¼Œå¤„ç†äº† 1985 ä¸ªä¹¦ç­¾
âœ… ç´¢å¼•å·²ä¿å­˜åˆ°æœ¬åœ°ç¼“å­˜
```

## ğŸš€ æ€§èƒ½æå‡

| åœºæ™¯ | ä¿®æ”¹å‰ | ä¿®æ”¹å | æå‡ |
|------|--------|--------|------|
| **æ— å˜åŒ–é‡å¯** | å®Œå…¨é‡å»ºï¼ˆ~5åˆ†é’Ÿï¼‰ | ç›´æ¥åŠ è½½ï¼ˆ<1ç§’ï¼‰ | **300x+** |
| **å°‘é‡æ–°å¢** | å®Œå…¨é‡å»ºï¼ˆ~5åˆ†é’Ÿï¼‰ | å¢é‡æ›´æ–°ï¼ˆ~10ç§’ï¼‰ | **30x** |
| **å¤§é‡å˜åŒ–** | å®Œå…¨é‡å»ºï¼ˆ~5åˆ†é’Ÿï¼‰ | å®Œå…¨é‡å»ºï¼ˆ~5åˆ†é’Ÿï¼‰ | æ— å˜åŒ– |

## ğŸ“ ä½¿ç”¨è¯´æ˜

### æ­£å¸¸ä½¿ç”¨æµç¨‹

1. **é¦–æ¬¡å®‰è£…**: å®Œæ•´ç´¢å¼•æ„å»ºï¼Œä¿å­˜åˆ° IndexedDB
2. **æµè§ˆå™¨é‡å¯**: 
   - âœ… ç­¾ååŒ¹é… â†’ ç§’çº§åŠ è½½
   - ğŸ”„ è½»å¾®å˜åŒ– â†’ å¢é‡æ›´æ–°ï¼ˆ~10ç§’ï¼‰
   - ğŸ”¨ å¤§é‡å˜åŒ– â†’ å®Œå…¨é‡å»ºï¼ˆ~5åˆ†é’Ÿï¼‰

### è°ƒè¯•æŠ€å·§

**æŸ¥çœ‹æ—¥å¿—**ï¼š
1. æ‰“å¼€ Chrome æ‰©å±•ç®¡ç†é¡µé¢ï¼š`chrome://extensions`
2. æ‰¾åˆ°"æ™ºèƒ½ä¹¦ç­¾æœç´¢"ï¼Œç‚¹å‡»"service worker"
3. åœ¨ Console ä¸­æŸ¥çœ‹è¯¦ç»†æ—¥å¿—

**æ‰‹åŠ¨æ¸…é™¤ç¼“å­˜**ï¼ˆå¼ºåˆ¶é‡å»ºï¼‰ï¼š
```javascript
// åœ¨ service worker æ§åˆ¶å°æ‰§è¡Œ
indexedDB.deleteDatabase('BookmarkSearchDB');
```

**æŸ¥çœ‹ç¼“å­˜çŠ¶æ€**ï¼š
```javascript
// åœ¨ service worker æ§åˆ¶å°æ‰§è¡Œ
const db = await indexedDB.open('BookmarkSearchDB', 1);
const tx = db.transaction('meta', 'readonly');
const meta = await tx.objectStore('meta').get('meta');
console.log('ç¼“å­˜ä¿¡æ¯:', meta);
```

## ğŸ”§ æŠ€æœ¯ç»†èŠ‚

### IndexedDB æ•°æ®ç»“æ„

**meta è¡¨**ï¼š
```javascript
{
  key: 'meta',
  signature: 'a3b5c7d9',           // ä¹¦ç­¾ç­¾å
  bookmarkIds: ['1', '2', '3'...], // ä¹¦ç­¾IDåˆ—è¡¨ï¼ˆç”¨äºå¢é‡æ£€æµ‹ï¼‰
  createdAt: 1234567890,           // åˆ›å»ºæ—¶é—´
  stats: {
    docCount: 1985,                // æ–‡æ¡£æ•°é‡
    idfCount: 15420,               // è¯æ±‡è¡¨å¤§å°
    termCount: 15420               // å€’æ’ç´¢å¼•æ¡ç›®æ•°
  }
}
```

**å…¶ä»–è¡¨**ï¼š
- `idf`: è¯æ±‡ â†’ IDFå€¼æ˜ å°„
- `norms`: æ–‡æ¡£ID â†’ èŒƒæ•°æ˜ å°„
- `docs`: æ–‡æ¡£ID â†’ ä¹¦ç­¾æ•°æ®
- `inv`: è¯æ±‡ â†’ å€’æ’åˆ—è¡¨

### å¢é‡æ›´æ–°çš„é™åˆ¶

ç”±äº TF-IDF ç®—æ³•çš„å…¨å±€æ€§ï¼Œå½“æœ‰æ–°å¢ä¹¦ç­¾æ—¶ï¼š
- **IDFå€¼** éœ€è¦é‡æ–°è®¡ç®—ï¼ˆä¾èµ–å…¨å±€æ–‡æ¡£é¢‘ç‡ï¼‰
- **å€’æ’ç´¢å¼•** éœ€è¦éƒ¨åˆ†æ›´æ–°

å› æ­¤å½“å‰å¢é‡æ›´æ–°ç­–ç•¥ï¼š
- âœ… åˆ é™¤æ“ä½œï¼šçœŸæ­£çš„å¢é‡ï¼ˆåªåˆ é™¤ç›¸å…³æ¡ç›®ï¼‰
- âš ï¸ æ–°å¢æ“ä½œï¼šéœ€è¦é‡æ–°å¤„ç†æ‰€æœ‰æ–‡æ¡£çš„IDFï¼ˆä½†è·³è¿‡å†…å®¹æŠ“å–ï¼‰

æœªæ¥ä¼˜åŒ–æ–¹å‘ï¼š
- ç¼“å­˜æ¯ä¸ªä¹¦ç­¾çš„é¡µé¢å†…å®¹ï¼Œæ–°å¢æ—¶æ— éœ€é‡æ–°æŠ“å–
- é‡‡ç”¨è¿‘ä¼¼IDFæ›´æ–°ç®—æ³•ï¼Œé¿å…å…¨é‡é‡ç®—

## ğŸ¯ æ•ˆæœéªŒè¯

### æµ‹è¯•æ­¥éª¤

1. **é¦–æ¬¡æ„å»ºæµ‹è¯•**ï¼š
   ```
   - å®‰è£…æ’ä»¶
   - è§‚å¯Ÿæ§åˆ¶å°æ—¥å¿—
   - åº”æ˜¾ç¤º "æ‰§è¡Œå®Œæ•´ç´¢å¼•é‡å»º"
   ```

2. **ç¼“å­˜åŠ è½½æµ‹è¯•**ï¼š
   ```
   - é‡å¯æµè§ˆå™¨
   - æ‰“å¼€æ’ä»¶
   - åº”æ˜¾ç¤º "å·²ä»æœ¬åœ°ç¼“å­˜åŠ è½½ç´¢å¼•ï¼Œè·³è¿‡é‡å»º"
   - æœç´¢åŠŸèƒ½æ­£å¸¸
   ```

3. **å¢é‡æ›´æ–°æµ‹è¯•**ï¼š
   ```
   - æ·»åŠ  1-2 ä¸ªæ–°ä¹¦ç­¾
   - é‡å¯æµè§ˆå™¨/é‡è½½æ’ä»¶
   - åº”æ˜¾ç¤º "æ£€æµ‹åˆ°å¢é‡å˜åŒ–"
   - å¿«é€Ÿå®Œæˆæ›´æ–°ï¼ˆ<30ç§’ï¼‰
   ```

4. **å®Œå…¨é‡å»ºæµ‹è¯•**ï¼š
   ```
   - æ¸…ç©ºæµè§ˆå™¨ç¼“å­˜
   - æˆ–åˆ é™¤ IndexedDB
   - åº”æ˜¾ç¤º "æ‰§è¡Œå®Œæ•´ç´¢å¼•é‡å»º"
   ```

## ğŸ“Œ æ³¨æ„äº‹é¡¹

1. **ä¹¦ç­¾ä¿®æ”¹æ£€æµ‹**: ä¿®æ”¹ä¹¦ç­¾æ ‡é¢˜/URLä¼šè§¦å‘é‡å»ºï¼ˆç­¾åå˜åŒ–ï¼‰
2. **æ•°æ®åº“ç‰ˆæœ¬**: IndexedDB ç‰ˆæœ¬ä¸º 1ï¼Œå‡çº§éœ€è¦è¿ç§»é€»è¾‘
3. **å­˜å‚¨é™åˆ¶**: Chrome æ‰©å±• IndexedDB é€šå¸¸æ— é…é¢é™åˆ¶
4. **å¹¶å‘å®‰å…¨**: å•ä¾‹æ¨¡å¼ç¡®ä¿åŒä¸€æ—¶é—´åªæœ‰ä¸€ä¸ªåˆå§‹åŒ–ä»»åŠ¡

## ğŸ”„ ç‰ˆæœ¬å†å²

- **v1.0**: åˆå§‹ç‰ˆæœ¬ï¼Œæ¯æ¬¡é‡å¯éƒ½é‡å»ºç´¢å¼•
- **v1.1**: æ·»åŠ åŸºç¡€ç¼“å­˜ï¼Œä½†ç­¾åè®¡ç®—ä¸ç¨³å®š
- **v1.2**: âœ¨ **å½“å‰ç‰ˆæœ¬** - ä¼˜åŒ–ç­¾å + å¢é‡æ›´æ–° + è¯¦ç»†æ—¥å¿—


